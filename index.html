<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BANANA HUB - KEY REGENERATOR</title>
    <style>
        body { margin:0; background:#0a0a0a; color:#FFE135; font-family: 'Segoe UI', sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; }
        .box { background:#111; padding:40px; border:3px solid #FFE135; border-radius:25px; text-align:center; width:360px; box-shadow:0 0 40px rgba(255,225,53,0.2); }
        .key { font-size:28px; font-weight:bold; color:#fff; background:#000; padding:20px; margin:20px 0; border-radius:15px; border:2px dashed #FFE135; letter-spacing: 2px; }
        button { background:#FFE135; border:none; padding:15px; width:100%; font-weight:900; cursor:pointer; border-radius:12px; font-size:16px; transition: 0.3s; }
        button:hover { background:#fff; transform: scale(1.02); }
        .timer { margin-top:20px; font-size:14px; color:#666; }
        #countdown { color:#ff4444; font-weight:bold; }
    </style>
</head>
<body>
    <div class="box">
        <h2 style="margin:0;">üçå BANANA CAT</h2>
        <p style="font-size:10px; color:#444;">DEVICE SECURED SYSTEM</p>
        
        <div id="key-display" class="key">LOADING...</div>
        
        <button onclick="copyKey()">COPY KEY</button>
        
        <div class="timer">
            H·ªá th·ªëng s·∫Ω Reset m√£ m·ªõi sau: <span id="countdown">10</span>s
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const hwid = params.get('hwid');

        async function fetchNewKey() {
            if(!hwid) {
                document.getElementById('key-display').innerText = "V√ÄO T·ª™ SCRIPT!";
                return;
            }

            try {
                // Th√™m RAND ƒë·ªÉ ph√° m·ªçi lo·∫°i Cache c·ªßa tr√¨nh duy·ªát
                const rand = Math.random();
                const res = await fetch(`/api/verify?hwid=${hwid}&update=${rand}`);
                const data = await res.json();

                document.getElementById('key-display').innerText = data.key;
                
                let timeLeft = data.ttl;
                const cd = document.getElementById('countdown');

                const loop = setInterval(() => {
                    timeLeft--;
                    if(timeLeft < 0) timeLeft = 0;
                    cd.innerText = timeLeft;

                    if(timeLeft <= 0) {
                        clearInterval(loop);
                        // RESET TO√ÄN TRANG ƒê·ªÇ L·∫§Y M√É M·ªöI
                        window.location.reload();
                    }
                }, 1000);

            } catch(e) {
                document.getElementById('key-display').innerText = "L·ªñI K·∫æT N·ªêI";
            }
        }

        fetchNewKey();

        function copyKey() {
            const k = document.getElementById('key-display').innerText;
            navigator.clipboard.writeText(k);
            alert("ƒê√£ Copy Key M·ªõi!");
        }
    </script>
</body>
</html>
